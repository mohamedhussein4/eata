!function(){const e=document.getElementById("validateMobileNumberInGift");let t=document.getElementById("msgLimitationError");const n=document.getElementById("submit-details"),a=document.getElementById("saveBtn"),d=document.getElementById("closeValidationMobileModal");let s="",o="",i=document.getElementById("validateMobileNumberModal"),l="";const r=document.getElementById("validateOtp");let c=document.querySelector(".verification-inputs-otp"),u=c?.querySelectorAll(".otp"),m=document.getElementById("otpErrorMsg");const b=!!e?.dataset.url;let v="/gift/SendOtp/";a&&"True"==a.dataset.disabled?(a.disabled=!1,a.classList.remove("d-none")):a&&"False"==a.dataset.disabled&&(a.disabled=!0,a.classList.add("d-none"));let y=document.querySelector("#mobileNumberContainer .country-code");i&&(l=new bootstrap.Modal(i)),b?$("#mobileNumberContainer .country-code").on("select2:selecting",(function(t){console.log(t.params.args.data.id),"1"==t.params.args.data.id?(a.disabled=!0,a.classList.add("d-none"),e.classList.remove("d-none")):(a.disabled=!1,a.classList.remove("d-none"),e.classList.add("d-none"))})):y&&(y.disabled=!0),e?.addEventListener("click",(function(d){d.preventDefault();let i=document.getElementById("SenderName");o=i.value;let r=document.getElementById("mobileNumberContainer").querySelector(".input-gifteeNumber"),c=document.getElementById("SenderNameErr"),u=document.getElementById("mobileNumberErr");if(r.addEventListener("input",(function(){u.classList.add("d-none"),"1"==$("#mobileNumberContainer .country-code").val()&&(e.disabled=!1,e.classList.remove("d-none"),a&&(a.disabled=!0,a.classList.add("d-none")),n&&(n.disabled=!0),e.dataset.validate=!1,t.textContent="")})),i.addEventListener("input",(function(){c.classList.add("d-none"),"1"==$("#mobileNumberContainer .country-code").val()&&(e.disabled=!1,e.classList.remove("d-none"),a&&(a.disabled=!0,a.classList.add("d-none")),n&&(n.disabled=!0),e.dataset.validate=!1,t.textContent="")})),o.trim().length>1&&r.value&&!r.classList.contains("error")){let n=document.getElementById("SenderNameErrSyn"),a=$("#validateMobileNumberWrapper .country-code option:selected").text();if(/[\?\*\]\[{}\\|~]/.test(o)||/[^a-zA-Z0-9\u0600-\u06FF\s]/.test(o))return n.classList.remove("d-none"),!1;if(n.classList.add("d-none"),!/^(5)[0-9]/.test(r.value)||9!=r.value.length)return t.textContent="رقم جوال غير صحيح",!1;t.textContent="";let d=a.match(/\d+/);d&&d[0];s="0"+r.value,this.disabled=!0,b&&(v=e.dataset.url),fetch(v+s,{method:"POST",headers:{"Content-Type":"application/json"},async:!1}).then((function(e){return e.json()})).then((function(e){e.isSuccess?(l.show(),setTimeout((()=>{document.getElementById("code1").focus()}),1e3)):t.textContent=e.result})).catch((function(e){alert("حدث خطأ أثناء إرسال الرسالة")}))}else o.trim().length<=1?c.classList.remove("d-none"):c.classList.add("d-none"),r.value||u.classList.remove("d-none")})),r?.addEventListener("click",(function(t){t.preventDefault();let d="";if(u.forEach((e=>{""!=e.value&&null!=e.value&&e.value||(e.classList.add("border-danger"),e.classList.remove("border-primary-green","valid"),m.textContent=""),d+=e.value})),""!==d&&6===d.length){let t=o;this.disabled=!0,m.textContent="";let i={mobileNumber:s,code:d,fullName:t};fetch("/gift/ValidateOtp/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i),async:!1}).then((e=>e.json())).then((t=>{if(t.isSuccess){l.hide();let t=$('<div class="toast align-items-center position-fixed z-index-1070 bottom-0 alert" role="alert" id="successToast" aria-live="assertive" aria-atomic="true">\n                        <div class="d-flex">\n                        <div class="toast-body">تم التحقق بنجاح </div>\n                        <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n                        </div>');$("#maincontent").prepend(t);var d=document.getElementById("successToast");new bootstrap.Toast(d).show(),n&&(n.disabled=!1),a&&(a.disabled=!1,a.classList.remove("d-none")),this.disabled=!1,u.forEach((e=>{e.value="",e.classList.remove("border-primary-green","valid")})),e.dataset.validate=!0,e.classList.add("d-none")}else m.textContent=t.result,this.disabled=!1,e.dataset.validate=!1})).catch((e=>{this.disabled=!1,this.dataset.validate=!1;document.getElementById("divOtp").querySelector(".field-validation-valid").textContent="حدث خطأ أثناء التحقق من الرمز"}))}})),document.querySelectorAll(".verification-inputs-otp input").forEach((function(e){e.addEventListener("keyup",(function(t){if(8!=t.keyCode){if(""!==t.currentTarget.value){var n=e.nextElementSibling;n&&"input"===n.tagName.toLowerCase()?n.focus():document.querySelector("#validateOtp").focus(),e.classList.add("border-primary-green","border-2")}}else{var a=e.previousElementSibling;a&&"input"===a.tagName.toLowerCase()&&(a.focus(),e.classList.remove("border-primary-green","border-2"))}}))})),d?.addEventListener("click",(function(){u.forEach((e=>{e.value="",e.classList.remove("border-primary-green","valid","border-danger")})),e.disabled=!1,m.textContent=""}))}();